<div ng-if="uiState.errorMessage" class="row">
    <div class="col-md-12">
        <alert type="danger" close="closeErrorMessageAlert()">{{uiState.errorMessage}}</alert>
    </div>
</div>
    
<div class="row">
    <div class="col-md-6 home-left-column">
        <div class="panel panel-default">
            <div class="panel-heading">Patients</div>

            <div class="panel-body">
                <sbx-grid
                    load-page="loadPatients(startIndex, count, orderByProperty, orderByDirection, filter)"
                    page-size="10"
                    page-sizes="[5, 10, 20, 50, 100]"
                    filter="true"
                    object-actions="patientActions"
                    object-selected="patientSelected(object)"
                    callbacks="callbacks.patientsTable"
                    empty-message="No patients found">

                    <sbx-grid-column property="patientName['value']" title="Name">
                    </sbx-grid-column>

                    <sbx-grid-column property="patientID['value']" title="Id">
                    </sbx-grid-column>

                    <sbx-grid-column property="patientBirthDate['value']" title="Birth Date">
                    </sbx-grid-column>

                    <sbx-grid-column property="patientSex['value']" title="Sex">
                    </sbx-grid-column>
                </sbx-grid>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Studies</div>

            <div class="panel-body">
                <sbx-grid
                    load-page="loadStudies(startIndex, count, orderByProperty, orderByDirection)"
                    page-size="10"
                    page-sizes="[5, 10, 20, 50, 100]"
                    sorting="false"
                    object-actions="studyActions"
                    object-selected="studySelected(object)"
                    callbacks="callbacks.studiesTable"
                    empty-message="No studies found">

                    <sbx-grid-column property="studyDescription['value']" title="Description">
                    </sbx-grid-column>

                    <sbx-grid-column property="studyDate['value']" title="Date">
                    </sbx-grid-column>

                    <sbx-grid-column property="studyID['value']" title="Id">
                    </sbx-grid-column>

                    <sbx-grid-column property="accessionNumber['value']" title="Accession Number">
                    </sbx-grid-column>

                    <sbx-grid-column property="patientAge['value']" title="Patient Age">
                    </sbx-grid-column>
                </sbx-grid>
            </div>
        </div>

        <div class="panel panel-default">
            <div class="panel-heading">Series</div>

            <div class="panel-body">
                <sbx-grid
                    load-page="loadSeries(startIndex, count, orderByProperty, orderByDirection)"
                    page-size="10"
                    page-sizes="[5, 10, 20, 50, 100]"
                    sorting="false"
                    object-actions="seriesActions"
                    object-selected="seriesSelected(object)"
                    callbacks="callbacks.seriesTable"
                    empty-message="No series found">

                    <sbx-grid-column property="seriesDescription['value']" title="Description">
                    </sbx-grid-column>

                    <sbx-grid-column property="seriesDate['value']" title="Date">
                    </sbx-grid-column>

                    <sbx-grid-column property="modality['value']" title="Modality">
                    </sbx-grid-column>

                    <sbx-grid-column property="protocolName['value']" title="Protocol Name">
                    </sbx-grid-column>

                    <sbx-grid-column property="bodyPartExamined['value']" title="Body Part Examined">
                    </sbx-grid-column>
                </sbx-grid>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <tabset>            
            <tab heading="Images">

                <hr>

                <form class="form-inline">
                    <div class="btn-group" dropdown>
                        <button type="button" class="btn btn-default dropdown-toggle" dropdown-toggle>Size <span class="caret"></span></button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a ng-click="uiState.seriesDetails.imageHeight = 50; updateImageUrls()" href="#">50</a></li>
                            <li><a ng-click="uiState.seriesDetails.imageHeight = 100; updateImageUrls()" href="#">100</a></li>
                            <li><a ng-click="uiState.seriesDetails.imageHeight = 150; updateImageUrls()" href="#">150</a></li>
                            <li class="divider"></li>
                            <li><a ng-click="uiState.seriesDetails.imageHeight = 0; updateImageUrls()" href="#">Original</a></li>
                        </ul>
                    </div>
                    &nbsp;&nbsp;&nbsp;&nbsp;
                    <div class="checkbox">
                        <label>
                            <input id="manual" type="checkbox" ng-model="uiState.seriesDetails.isWindowManual" ng-change="updateImageUrls()"> Window (min/max)
                        </label>
                    </div>
                    &nbsp;
                    <div class="form-group">
                        <input type="number" class="form-control" id="min" placeholder="0" ng-model="uiState.seriesDetails.windowMin" ng-disabled="!uiState.seriesDetails.isWindowManual" ng-change="updateImageUrls()">
                    </div>
                    <div class="form-group">
                        <input type="number" class="form-control" id="max" placeholder="0" ng-model="uiState.seriesDetails.windowMax" ng-disabled="!uiState.seriesDetails.isWindowManual" ng-change="updateImageUrls()">
                    </div>                
                </form>

                <hr>

                <div class="clearfix">
                    <img ng-repeat="imageUrl in uiState.seriesDetails.imageUrls | orderBy:'frameIndex'" class="frame-image" ng-src="{{imageUrl.url}}" alt=""></img>
                </div>
            </tab>


            <tab heading="DICOM Tags">
                <sbx-grid
                    load-page="loadImageAttributes(0, 1000000000)"
                    page-size="1000000000"
                    sorting="false"
                    callbacks="callbacks.imageAttributesTable"
                    empty-message="No image atributes found">

                    <sbx-grid-column property="group" title="Group">
                    </sbx-grid-column>

                    <sbx-grid-column property="element" title="Element">
                    </sbx-grid-column>

                    <sbx-grid-column property="vr" title="VR">
                    </sbx-grid-column>

                    <sbx-grid-column property="length" title="Length">
                    </sbx-grid-column>

                    <sbx-grid-column property="name" title="Name">
                    </sbx-grid-column>

                    <sbx-grid-column property="value" title="Value">
                    </sbx-grid-column>

                    <sbx-grid-column property="path" title="Path">
                    </sbx-grid-column>

                </sbx-grid>            
            </tab>
        </tabset>
    </div>
</div>